<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Courses - Godot 3D MP LMS</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/lms.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Mux Player -->
    <script src="https://cdn.jsdelivr.net/npm/@mux/mux-player"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <div class="logo">GODOT 3D MP</div>
                
                <!-- Desktop Navigation -->
                <div class="nav-links">
                    <a href="index.html">Home</a>
                    <a href="#dashboard">Dashboard</a>
                    <a href="#progress">My Progress</a>
                </div>
                
                <!-- Desktop User Menu -->
                <div class="user-menu">
                    <span id="userEmail" class="user-email"></span>
                    <span id="userTier" class="user-tier"></span>
                    <button id="logoutBtn" class="cta-button logout-btn">Logout</button>
                </div>
                
                <!-- Mobile Menu Button -->
                <button class="mobile-menu-btn" id="mobileMenuBtn">‚ò∞</button>
            </nav>
        </div>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-header">
                <div class="mobile-menu-logo">GODOT 3D MP</div>
                <button class="mobile-close-btn" id="mobileCloseBtn">‚úï</button>
            </div>
            
            <div class="mobile-nav-links">
                <a href="index.html" onclick="closeMobileMenu()">Home</a>
                <a href="#dashboard" onclick="closeMobileMenu()">Dashboard</a>
                <a href="#progress" onclick="closeMobileMenu()">My Progress</a>
                
                <!-- Mobile User Info -->
                <div class="mobile-user-menu">
                    <div class="mobile-user-email" id="mobileUserEmail"></div>
                    <div class="mobile-user-tier" id="mobileUserTier"></div>
                    <button class="mobile-logout-btn" id="mobileLogoutBtn">Logout</button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    </header>

    <!-- Authentication Required Message -->
    <div id="authRequired" class="auth-required-message">
        <div class="container">
            <div class="auth-message">
                <h2>Authentication Required</h2>
                <p>Please log in to access the course content.</p>
                <a href="login.html" class="cta-button">Login / Sign Up</a>
            </div>
        </div>
    </div>

    <!-- LMS Dashboard -->
    <section id="dashboard" class="lms-dashboard" style="display: none;">
        <div class="container">
            <div class="dashboard-header">
                <h1>Godot Multiplayer Courses</h1>
                <div class="user-info">
                    <p>Email: <span id="displayEmail"></span></p>
                    <p>Tier: <strong id="displayTier"></strong></p>
                    <p>Progress: <span id="displayProgress">0%</span></p>
                </div>
            </div>

            <!-- Upgrade Banner for Basic Users -->
            <div id="upgradeBanner" class="upgrade-banner" style="display: none;">
                <div class="upgrade-content">
                    <h3>üöÄ Upgrade to Premium!</h3>
                    <p>Get access to all premium content, downloads, and exclusive features.</p>
                    <button class="cta-button" onclick="showUpgradeModal()">Upgrade Now - $100</button>
                </div>
            </div>

            <!-- Courses View -->
            <div id="coursesView" class="courses-view">
                <h2>Available Courses</h2>
                <div class="subscription-info">
                    <p>Current Tier: <strong id="currentTier">Basic</strong></p>
                    <p>Enrolled Courses: <strong id="purchasedCount">0</strong></p>
                    <p>Completed Modules: <strong id="completedCount">0</strong></p>
                </div>
                <div id="coursesContainer" class="courses-grid">
                    <!-- Courses will be loaded here -->
                </div>
            </div>

            <!-- Course Details View -->
            <div id="courseDetailsView" class="course-details-view" style="display: none;">
                <button id="backToCourses" class="back-button" onclick="backToCourses()">‚Üê Back to Courses</button>
                <div class="course-details-container">
                    <div class="course-header-details">
                        <h2 id="courseDetailTitle"></h2>
                        <p id="courseDetailDescription"></p>
                        <div class="course-meta-details">
                            <span class="course-tier-badge" id="courseDetailTier"></span>
                            <span class="course-price" id="courseDetailPrice"></span>
                            <span class="progress-badge" id="courseProgressBadge">0% Complete</span>
                        </div>
                    </div>

                    <div class="course-content">
                        <!-- Video Player Section -->
                        <div class="video-section" id="videoSection" style="display: none;">
                            <h3>Now Playing: <span id="currentModuleTitle"></span></h3>
                            <div class="video-container">
                                <div id="videoPlayer" class="video-player">
                                    <!-- Mux Player will be loaded here -->
                                </div>
                            </div>
                            <div class="video-controls">
                                <button id="prevModule" class="control-btn nav-btn">‚Üê Previous</button>
                                <button id="completeModule" class="control-btn play-btn">Mark Complete</button>
                                <button id="nextModule" class="control-btn nav-btn">Next ‚Üí</button>
                            </div>
                            <div class="video-info">
                                <h4>About This Module</h4>
                                <p id="moduleDescription"></p>
                                <div class="video-meta">
                                    <span>Duration: <span id="moduleDuration"></span></span>
                                    <span>Tier: <span id="moduleTier"></span></span>
                                    <span>Status: <span id="moduleStatus">Not Started</span></span>
                                </div>
                            </div>
                        </div>

                        <!-- Modules Section -->
                        <div class="modules-section">
                            <h3>Course Content</h3>
                            <div id="modulesList" class="modules-list">
                                <!-- Modules will be loaded here -->
                            </div>
                        </div>

                        <!-- Downloads Section -->
                        <div class="downloads-section">
                            <h3>Resources & Downloads</h3>
                            <div id="downloadsList" class="downloads-list">
                                <!-- Downloads will be loaded here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Progress Overview -->
    <section id="progress" class="progress-overview" style="display: none;">
        <div class="container">
            <h2>Your Learning Progress</h2>
            <div class="progress-grid">
                <div class="progress-card">
                    <h3>Course Completion</h3>
                    <div class="progress-circle">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle cx="60" cy="60" r="54" fill="none" stroke="#333" stroke-width="8"/>
                            <circle id="completionCircle" cx="60" cy="60" r="54" fill="none" stroke="#ff6b35" stroke-width="8" stroke-dasharray="339.292" stroke-dashoffset="339.292" transform="rotate(-90 60 60)"/>
                        </svg>
                        <span id="completionPercent" class="completion-percent">0%</span>
                    </div>
                </div>

                <div class="progress-card">
                    <h3>Your Subscription</h3>
                    <div class="subscription-status">
                        <div class="tier-info">
                            <span class="tier-label">Current Tier:</span>
                            <span id="progressTier" class="tier-value">Basic</span>
                        </div>
                        <div class="upgrade-options">
                            <button class="upgrade-btn premium" onclick="showUpgradeModal()">Upgrade to Premium - $100</button>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="progress-card">
                    <h3>Recent Activity</h3>
                    <div class="activity-list" id="userActivityList">
                        <div class="activity-item">No recent activity</div>
                    </div>
                </div>
            </div>

            <!-- Course Progress Details -->
            <div class="course-progress-details">
                <h3>Course Progress</h3>
                <div id="courseProgressList" class="progress-list">
                    <!-- Course progress will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Upgrade Modal -->
    <div id="upgradeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upgrade to Premium</h3>
                <button class="close-btn" onclick="closeUpgradeModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="premium-features">
                    <h4>üéÅ Premium Features:</h4>
                    <ul>
                        <li>‚úÖ Access to all premium modules</li>
                        <li>‚úÖ Downloadable resources & assets</li>
                        <li>‚úÖ Priority support</li>
                        <li>‚úÖ Certificate of completion</li>
                        <li>‚úÖ Future content updates</li>
                    </ul>
                </div>
                <div class="payment-options">
                    <h4>Select Payment Method:</h4>
                    <button class="payment-btn stripe" onclick="processUpgrade('stripe')">Pay with Stripe - $100</button>
                    <button class="payment-btn paypal" onclick="processUpgrade('paypal')">Pay with PayPal - $100</button>
                    <button class="payment-btn manual" onclick="processUpgrade('manual')">Manual Payment</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Purchase Modal -->
    <div id="purchaseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Purchase Course</h3>
                <button class="close-btn" onclick="closePurchaseModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <p>You are purchasing: <strong id="purchaseCourseTitle"></strong></p>
                <p>Price: <strong id="purchaseCoursePrice"></strong></p>
                <p>Your tier will be upgraded to: <strong id="purchaseTierUpgrade"></strong></p>
                
                <div class="payment-options">
                    <h4>Select Payment Method:</h4>
                    <button class="payment-btn stripe" onclick="processPayment('stripe')">Pay with Stripe</button>
                    <button class="payment-btn paypal" onclick="processPayment('paypal')">Pay with PayPal</button>
                    <button class="payment-btn manual" onclick="processPayment('manual')">Manual Payment</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/lms-enhanced.js"></script>
</body>
</html>
